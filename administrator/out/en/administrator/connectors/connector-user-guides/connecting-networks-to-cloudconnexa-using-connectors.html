<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><meta name="search" content="algolia"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="0"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><title>Connecting Networks to CloudConnexa Using Connectors</title><link rel="stylesheet" type="text/css" href="../../../../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/theme0.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/theme0-colors.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/html5.algoliasearch.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../../../../css/layout-custom-style.css"></link><meta xmlns:xhtml="http://www.w3.org/1999/xhtml" name="generator" content="Paligo"></meta><meta name="keywords" content="CloudConnexa formerly known as OpenVPN Cloud, CloudConnexa Administrator"></meta><link rel="prev" href="connector-deployment-user-guides.html" title="Connector Deployment User Guides"></link><link rel="next" href="user-guide---using-multiple-connectors-to-increase-reliability-of-remote-access.html" title="User Guide - Using multiple Connectors to increase reliability of Remote Access"></link><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/googlecode.min.css"></link></head><body class="theme0 page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix="../../../"><style type="text/css">
            div.skipnav {
            }
            div.skipnav a {
                position: fixed;
                left: -10000px;
                top: 1.5em;
                width: 1px;
                height: 1px;
                overflow: hidden;
            }
            div.skipnav a:focus, div.skipnav a:active, div.skipnav a:hover {
                background: white;
                color: black;
                box-shadow: 5px 5px 5px 0px rgba(0,0,0,0.5);
                position: fixed;
                left: 2em;
                top: 1.5em;
                width: auto;
                height: auto;
                overflow: visible;
                text-decoration: underline;
                z-index: 99999; /* has to be higher than the side panel */
    }
          </style><div class="skipnav"><a href="#content-wrapper">Skip to main content</a></div><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="/cloud-docs/index.html" target="_blank" rel="noopener"><img id="logotype-pageheader" src="../../../../css/image/corporate-logo.svg" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div class="collapse" id="navbar-collapse"><ul class="version-menu sm sm-simple"><li class="version-dropdown"><a><span class="caret"></span>Select version</a><ul class="version-dropdown"><li><a href="/cloud-docs/owner/index.html">Owner Documentation</a></li><li><a href="/cloud-docs/administrator/index.html">Admin Documentation</a></li><li><a href="/cloud-docs/user/index.html">User Documentation</a></li><li><a href="/cloud-docs/developer/index.html">Developer Documentation</a></li></ul></li></ul></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/cloud-docs/index.html" target="_blank" rel="noopener"><img id="logotype-pageheader" src="../../../../css/image/corporate-logo.svg" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><div class="toolbar top-nav-on"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"><ul class="version-menu sm sm-simple"><li class="version-dropdown"><a><span class="caret"></span>Select version</a><ul class="version-dropdown"><li><a href="/cloud-docs/owner/index.html">Owner Documentation</a></li><li><a href="/cloud-docs/administrator/index.html">Admin Documentation</a></li><li><a href="/cloud-docs/user/index.html">User Documentation</a></li><li><a href="/cloud-docs/developer/index.html">Developer Documentation</a></li></ul></li></ul></div><div class="tool-print"><i class="fa fa-print" aria-hidden="true">print</i></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"><a href="../../../index-en.html">Knowledge Base</a></li><li class="breadcrumb-link"><a href="../../../administrator.html"><span class="bold"><strong>Administrator</strong></span></a></li><li class="breadcrumb-link"><a href="../../connectors.html"><span class="bold"><strong>Connectors</strong></span></a></li><li class="breadcrumb-link"><a href="../connector-user-guides.html"><span class="bold"><strong>Connector User Guides</strong></span></a></li><li class="breadcrumb-node">Connecting Networks to CloudConnexa Using Connectors</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" class="prev pull-left prev visible-lg visible-md" id="header-navigation-prev" href="connector-deployment-user-guides.html">Prev</a></li><li class="next"><a accesskey="n" class="pull-right next visible-lg visible-md" id="header-navigation-next" href="user-guide---using-multiple-connectors-to-increase-reliability-of-remote-access.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section reused-publication" data-origin-id="UUID-6b5e5713-a0bb-11ba-573b-2cb3552b8dc6" data-permalink="administrator/connectors/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html" data-topic-level="4" data-relative-prefix="../../../" data-publication-date="" id="UUID-6b5e5713-a0bb-11ba-573b-2cb3552b8dc6"><div class="titlepage"><div><div class="title"><h1 class="title" style="clear: both">Connecting Networks to CloudConnexa Using Connectors</h1></div></div></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-c55ab03f-889b-9df8-271c-e9415269eecb" data-publication-date="" id="UUID-8a8036df-9c9a-d724-991a-22827a1d5e59"><div class="titlepage"></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-629eb15e-2345-537a-c617-3c066f220fc1" data-publication-date="" id="UUID-1c56ca39-c7a8-a2d7-36b3-914cd65823e1"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Introduction</strong></span></h3></div></div></div><p>Additional steps need to be taken after downloading and installing <span class="bold"><strong>Connector</strong></span> software to ensure that proper routing of traffic occurs between your Networks and CloudConnexa. In this document, we take an in-depth look at traffic flows to help you understand why certain actions need to be taken and to also provide instructions and references for configuring the required functionality on the instance running the <span class="bold"><strong>Connector</strong></span>.</p><p>We hope that this document helps in explaining the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>The reason routing needs to be enabled on the instance running the <span class="bold"><strong>Connector</strong></span> for a <span class="bold"><strong>Network</strong></span></p></li><li class="listitem"><p>The reasoning behind adding static routes to your Network’s router</p></li><li class="listitem"><p>When using <span class="bold"><strong>NAT</strong></span> on the instance running the <span class="bold"><strong>Connector</strong></span> might help</p></li></ul></div></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-8c0cf60f-d721-cf4d-623f-06743ede1dab" data-publication-date="" id="UUID-d6a61ea7-3675-24e0-88d2-3682d4649ce9"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Remote access to private services</strong></span></h3></div></div></div><p>In this section, the traffic flow between a remote User that is connected to the CloudConnexa to access the HR application on the HQ Network is examined.</p><p>As shown in the figure, HQ Network is made up of the 10.0.0.0/18 subnet and a computer running <span class="bold"><strong>Ubuntu</strong></span> is acting as the <span class="bold"><strong>Connector</strong></span> on IP address <code class="code">10.0.0.10</code>. The HR application server is at <code class="code">10.0.0.20</code>. The HQ Network is connected to the Internet by a router that performs Network Address Translation (<span class="bold"><strong>NAT</strong></span>) to provide the computers on the internal private Network with access to the Internet.</p><p>To make the routing work the following needs to be done:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Connector software needs to be installed on a computer in HQ Network (see, the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-bd814724-cb47-7e0e-47fc-2dd824888b5c" title="Installation of Connector">Connector installation</a></strong></span>).</p></li><li class="listitem"><p>Routing needs to be enabled on the computer running the Connector software (see, the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530" title="Enable Routing">Enable Routing</a></strong></span> ).</p></li><li class="listitem"><p>Either NAT must be enabled on the computer running the Connector software (see, the section on enabling NAT) OR a static route needs to be added to the router on HQ Network (see, section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes">Static Routing</a></strong></span>).</p></li></ol></div><div class="mediaobject"><img src="../../../image/uuid-b6296272-d965-d282-7147-c044bc0d3909.png" style="" alt="62e9bafe58266.png"></img></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The Admin adds a Network using the CloudConnexa Administration portal. The name of ‘HQ Network’ is given to the Network and <code class="code">10.0.0.0/18</code> is added as its subnet.</p></li><li class="listitem"><p>CloudConnexa in the background assigns <code class="code">100.96.0.100</code> as the WPC IP address for the Connector created for HQ Network and configures its routing table to route all traffic destined to the HQ Network’s subnets (<code class="code">10.0.0.0/18</code>) to be forwarded to its <span class="bold"><strong>Connector</strong></span> (<code class="code">100.96.0.100</code>).</p></li><li class="listitem"><p>Admin downloads and installs the <span class="bold"><strong>Connector</strong></span> software and connects with the CloudConnexa <span class="bold"><strong>Profile</strong></span> to establish WPC connection to the preconfigured CloudConnexa <span class="bold"><strong>Region</strong></span>.</p></li><li class="listitem"><p>During WPC connection establishment CloudConnexa pushes down a route to the WPC Subnet range (<code class="code">100.96.0.0/11</code>).</p></li><li class="listitem"><p>Once the connection is established, the WPC is represented by a virtual interface that receives packets from the WPC and will be used to send packets destined to <code class="code">100.96.0.0/11</code>.</p></li><li class="listitem"><p>Admin configures a User named Bob in a User Group that has its <span class="bold"><strong>Internet Access</strong></span> set to (<span class="bold"><strong>Split-Tunnel ON</strong></span>).</p></li><li class="listitem"><p>Bob receives the invitation email, downloads the Connect client, and imports the <span class="bold"><strong>Profile</strong></span> after selecting the closest <span class="bold"><strong>Region</strong></span>.</p></li><li class="listitem"><p>On connection, because <span class="bold"><strong>Split-Tunnel</strong></span> is <span class="bold"><strong>ON</strong></span> the virtual interface receives routes for both the CloudConnexa WPC IP subnet range as well as the subnet range of HQ Network.</p></li><li class="listitem"><p>Bob tries to access the HR application. As the HR application is in the HQ Network the packet is routed via the WPC interface.</p></li><li class="listitem"><p>When CloudConnexa receives the packet it checks its routing table and directs the packet to the <span class="bold"><strong>Connector</strong></span> in HQ Network because of the destination IP address is in the subnet configured for HQ Network.</p></li><li class="listitem"><p>When the Connector instance receives the packet destined to <code class="code">10.0.0.20</code> it drops it because the computer only expects to receive packets destined to it at either <code class="code">10.0.0.10</code> or <code class="code">100.96.0.100</code>.</p></li><li class="listitem"><p>In order for the Connector instance to accept the packet destined at <code class="code">10.0.0.20</code> received from its WPC interface and send it to the HQ Network LAN, the <span class="bold"><strong>Connector</strong></span> needs to be configured to act as a router and forward IP packets using the right interface. Please see the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530" title="Enable Routing">Enable Routing</a></strong></span>.</p></li><li class="listitem"><p>Now that routing is enabled, the <span class="bold"><strong>Connector</strong></span> instance forwards the received packet on the LAN interface in order to reach the HR Application server.</p></li><li class="listitem"><p>The Application server responds to the packet and because of not knowing where to send the packet destined to an IP address in <code class="code">100.96.0.0/11</code> it sends it to its default route which is the router.</p></li><li class="listitem"><p>When the router receives the packet, it drops it because there are no entries on how to route this packet, and the destination IP address is not routable on the internet.</p></li><li class="listitem"><p>To resolve this issue, a static route can be added to the router informing it to forward all traffic destined to <code class="code">100.96.0.0/11</code> to the Connector instance. See section for <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes">Add Static Routes</a></strong></span> for references.</p></li><li class="listitem"><p>With the static route in place, the packet is forwarded to the <span class="bold"><strong>Connector</strong></span> instance which, being already configured as a router, can route it via the WPC to its final destination (<span class="bold"><strong>steps 21-22</strong></span>).</p></li><li class="listitem"><p>As an alternative to configuring the router with a static route, <span class="bold"><strong>NAT</strong></span> can be enabled on the <span class="bold"><strong>Connector</strong></span> instance. When <span class="bold"><strong>NAT</strong></span> is turned <span class="bold"><strong>ON</strong></span>, the <span class="bold"><strong>Connector</strong></span> instance will substitute its <span class="bold"><strong>IP address</strong></span> for the original source IP address, and on receiving the response, switch the destination to the original source IP. Please see the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-902d63f8-9840-8ce8-d0c3-ac8d04e12b23" title="Enable NAT">Enable NAT</a></strong></span>.</p></li><li class="listitem"><p>The packet now gets forwarded by the <span class="bold"><strong>Connector</strong></span> instance as well as undergoes <span class="bold"><strong>NAT</strong></span> so that when the packet is received by the <span class="bold"><strong>Application Server</strong></span> it need not forward the response to the router but send the response right back to the <span class="bold"><strong>Connector</strong></span> Instance.</p></li><li class="listitem"><p>On receiving the response, the <span class="bold"><strong>Connector</strong></span> instance translates the destination and can forward the response on the WPC interface.</p></li><li class="listitem"><p>The response reaches the <span class="bold"><strong>Connector</strong></span> instance either by use of Option 1 (static route) or Option 2 (NAT) and is sent to CloudConnexa.</p></li><li class="listitem"><p>CloudConnexa forwards the packet to Bob.</p></li></ol></div><p>Option 1 or Option 2 — which is better? The static route Option 1 is better if you anticipate sending unsolicited traffic to remote clients from the Network. For example, if you want to ping Bob’s WPC IP address from the Application Server. NAT Option 2 is fine as long as all traffic sessions are always initiated by the remote client.</p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-0f15e187-7533-446f-0ec8-fb2b27077a0c" data-publication-date="" id="UUID-56e65918-8289-cdf6-15cd-ad3f67b0e5bd"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>HQ Network being used as Internet Gateway route</strong></span></h3></div></div></div><p>In this traffic flow, we see how internet traffic exiting CloudConnexa and egressing from HQ Network is handled.</p><p>As shown in the figure, HQ Network is made up of the <code class="code">10.0.0.0/18</code> subnet and a computer running Ubuntu is acting as the <span class="bold"><strong>Connector</strong></span> on IP address <code class="code">10.0.0.10</code>. The HQ Network is connected to the Internet by a router that performs Network Address Translation (<span class="bold"><strong>NAT</strong></span>) to provide the computers on the internal private Network with access to the Internet. The service on the internet that is being accessed by Bob is at the IP address of <code class="code">107.3.152.27</code>.</p><p>To make the routing work the following needs to be done:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="bold"><strong>Connector</strong></span> software needs to be installed on a computer in HQ Network (see, the section on Connector installation).</p></li><li class="listitem"><p>Routing needs to be enabled on the computer running the <span class="bold"><strong>Connector</strong></span> software (see, the section on enabling routing).</p></li><li class="listitem"><p>Either <span class="bold"><strong>NAT</strong></span> must be enabled on the computer running the <span class="bold"><strong>Connector</strong></span> software (see, the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-902d63f8-9840-8ce8-d0c3-ac8d04e12b23" title="Enable NAT">enabling NAT</a></strong></span>) OR a static route needs to be added to the router on HQ Network (see, section on <a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes"><span class="bold"><strong>static routing</strong></span></a>).</p></li></ol></div><div class="mediaobject"><img src="../../../image/uuid-fa4cdcb1-8bd2-03e8-9bb3-270b329f5a10.png" style="" alt="62e9bb00b1ac4.png"></img></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The Admin marks HQ Network as an egress route for the WPC using the CloudConnexa Administration portal.</p></li><li class="listitem"><p>In the background, CloudConnexa adds the IP address of the HQ Network <span class="bold"><strong>Connector</strong></span> as the default route for the WPC.</p></li><li class="listitem"><p>The Admin sets the internet access of the User Group to which Bob belongs to <span class="bold"><strong>Split-Tunnel OFF</strong></span>.</p></li><li class="listitem"><p>Bob’s WPC connection is reset and CloudConnexa is made the default route destination.</p></li><li class="listitem"><p>Bob tries to access an Internet application (server IP address of <code class="code">107.3.152.27</code>). As CloudConnexa is the default route, the packet is routed via the WPC interface.</p></li><li class="listitem"><p>When CloudConnexa receives the packet it checks its routing table and directs the packet to the Connector in HQ Network because it has been set as the egress route for the WPC.</p></li><li class="listitem"><p>When the Connector instance receives the packet destined to <code class="code">107.3.152.27</code> it drops it because the computer only expects to receive packets destined to it at either <code class="code">10.0.0.10</code> or <code class="code">100.96.0.100</code>.</p></li><li class="listitem"><p>In order for the <span class="bold"><strong>Connector</strong></span> instance to accept the packet destined at <code class="code">107.3.152.27</code> received from its WPC interface and send it to the HQ Network LAN, the <span class="bold"><strong>Connector</strong></span> needs to be configured to act as a router and forward IP packets using the right interface. Please see the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530" title="Enable Routing">Enable Routing</a></strong></span>.</p></li><li class="listitem"><p>Now that routing is enabled, the Connector instance forwards the received packet on the <span class="bold"><strong>LAN</strong></span> interface in order to reach the Network’s router.</p></li><li class="listitem"><p>The router performs <span class="bold"><strong>NAT</strong></span> and forwards the packet to the server on the Internet.</p></li><li class="listitem"><p>When the router receives the response, it performs the <span class="bold"><strong>NAT</strong></span> translation to get the destination address as an IP address in <code class="code">100.96.0.0/11</code>.</p></li><li class="listitem"><p>The router drops the response because there are no entries on how to route this packet, and the destination IP address is not routable on the internet.</p></li><li class="listitem"><p>To resolve this issue, a static route can be added to the router informing it to forward all traffic destined to <code class="code">100.96.0.0/11</code> to the Connector instance. See section for <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes">Add Static Routes</a></strong></span> for references.</p></li><li class="listitem"><p>With the static route in place, the packet is forwarded to the Connector instance which, being already configured as a router, can route it via the WPC to its final destination (<span class="bold"><strong>steps 20-21</strong></span>).</p></li><li class="listitem"><p>As an alternative to configuring the router with a static route, <span class="bold"><strong>NAT</strong></span> can be enabled on the <span class="bold"><strong>Connector</strong></span> instance. When <span class="bold"><strong>NAT</strong></span> is turned <span class="bold"><strong>ON</strong></span>, the <span class="bold"><strong>Connector</strong></span> instance will substitute its <span class="bold"><strong>IP address</strong></span> for the original <span class="bold"><strong>source</strong></span> IP address, and on receiving the response, switch the destination to the original source IP. Please see the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-902d63f8-9840-8ce8-d0c3-ac8d04e12b23" title="Enable NAT">Enable NAT</a></strong></span>.</p></li><li class="listitem"><p>The packet now gets forwarded by the <span class="bold"><strong>Connector</strong></span> instance as well as undergoes <span class="bold"><strong>NAT</strong></span> so that when the packet is received by the router the source IP address is <code class="code">10.0.0.10</code> and not the IP address in <code class="code">100.96.0.0/11</code>.</p></li><li class="listitem"><p>The router performs <span class="bold"><strong>NAT</strong></span> and forwards the packet to the server on the Internet.</p></li><li class="listitem"><p>When the router receives the response, it performs the <span class="bold"><strong>NAT</strong></span> translation to get the destination address as <code class="code">10.0.0.10</code> (because the <span class="bold"><strong>Connector</strong></span> instance had performed <span class="bold"><strong>NAT</strong></span> on <span class="bold"><strong>step 16</strong></span>) and forwards the response to the <span class="bold"><strong>Connector</strong></span> instance.</p></li><li class="listitem"><p>On receiving the response, the <span class="bold"><strong>Connector</strong></span> instance translates the destination back to the IP address in <code class="code">100.96.0.0/11</code> and can forward the response on the WPC interface.</p></li><li class="listitem"><p>The response reaches the <span class="bold"><strong>Connector</strong></span> instance either by use of <span class="bold"><strong>Option 1</strong></span> (static route) or <span class="bold"><strong>Option 2</strong></span> (NAT) and is sent to CloudConnexa.</p></li><li class="listitem"><p>CloudConnexa forwards the packet to Bob.</p></li></ol></div><p>Option 1 or Option 2 which option is better? The static route Option 1 is better if you anticipate sending unsolicited traffic to remote clients from the Network and if the router will perform NAT for source IP addresses that do not belong to the HQ Network. NAT Option 2 is fine as long as all traffic sessions are always initiated by the remote client.</p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-a2dd21c0-3282-0682-b2bb-b91e3756026a" data-publication-date="" id="UUID-37db5cc5-5025-30c3-282e-06a56cc941b1"><div class="titlepage"><div><div class="title"><h3 class="title">Site-to-Site</h3></div></div></div><p>The flow below shows the traffic flows between two sites connected to CloudConnexa: HQ Network and Branch Network.</p><p>To make the routing work the following needs to be done:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><span class="bold"><strong>Connector</strong></span> software needs to be installed on a computer in HQ Network and Branch Network (see, the section on <span class="bold"><strong>Connector installation</strong></span>).</p></li><li class="listitem"><p>Routing needs to be enabled on the computer running the <span class="bold"><strong>Connector</strong></span> software (see, the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530" title="Enable Routing">Enable Routing</a></strong></span>).</p></li><li class="listitem"><p><span class="bold"><strong>For proper routing here it is mandatory to add static routes to the Network routers on both sites. As new sites are added to CloudConnexa, it is mandatory to add to the existing static routes on each site with a route to the new Network’s subnets.</strong></span> See, the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes">Static Routing</a></strong></span>.</p></li><li class="listitem"><p>Additionally, <span class="bold"><strong>NAT</strong></span> can be enabled on the <span class="bold"><strong>Connector</strong></span> instance too if there are internal firewalls or security groups around your Application servers that accept packets only from subnets belonging to the local Network (see, the section on enabling <span class="bold"><strong>NAT</strong></span>).</p></li></ol></div><div class="mediaobject"><img src="../../../image/uuid-2de4af17-36c6-0596-a104-87768b2fd80c.png" style="" alt="62e9bb02af7d9.png"></img></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The Administrator adds a Network using the CloudConnexa Administration portal. The name of ‘HQ Network’ is given to the Network and <code class="code">10.0.0.0/18</code> is added as its subnet.</p></li><li class="listitem"><p>CloudConnexa in the background assigns <code class="code">100.96.0.100</code> as the WPC IP address for the <span class="bold"><strong>Connector</strong></span> created for HQ Network and configures its routing table to route all traffic destined to the HQ Network’s subnets (<code class="code">10.0.0.0/18</code>) to be forwarded to its Connector (<code class="code">100.96.0.100</code>).</p></li><li class="listitem"><p>Admin downloads and installs the <span class="bold"><strong>Connector</strong></span> software and connects with the CloudConnexa <span class="bold"><strong>Profile</strong></span> to establish WPC connection to the preconfigured CloudConnexa <span class="bold"><strong>Region</strong></span>.</p></li><li class="listitem"><p>During WPC connection establishment CloudConnexa pushes down a route to the WPC Subnet range (<code class="code">100.96.0.0/11</code>).</p></li><li class="listitem"><p>Once the connection is established, the WPC is represented by a virtual interface that receives packets from the WPC and will be used to send packets destined to <code class="code">100.96.0.0/11</code>.</p></li><li class="listitem"><p>In order for the <span class="bold"><strong>Connector</strong></span> instance to accept the packets received from its WPC interface and send it to the HQ Network LAN, the Connector needs to be configured to act as a router and forward IP packets using the right interface. Please see the section on <span class="bold"><strong><a class="link linktype-fork" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530" title="Enable Routing">Enable Routing</a></strong></span>.</p></li><li class="listitem"><p>A static route is added to the router informing it to forward all traffic destined to CloudConnexa (<code class="code">100.96.0.0/11</code>) to the Connector instance. See section for <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes">Add Static Routes</a></strong></span> for references.</p></li><li class="listitem"><p>The Administrator adds a Network using the CloudConnexa Administration portal. The name of ‘Branch Network’ is given to the Network and <code class="code">192.168.0.0/22</code> is added as its subnet.</p></li><li class="listitem"><p>CloudConnexa in the background assigns <code class="code">100.96.0.300</code> as the WPC IP address for the Connector created for Branch Network and configures its routing table to route all traffic destined to the Branch Network’s subnets (<code class="code">192.168.0.0/22</code>) to be forwarded to its Connector (<code class="code">100.96.0.300</code>).</p></li><li class="listitem"><p>WPC Connection to HQ Network’s Connector is quickly reset to push the new route of <code class="code">192.168.0.0/22</code>.</p></li><li class="listitem"><p>Now the WPC virtual interface will be used to reach both CloudConnexa and Branch Network.</p></li><li class="listitem"><p>Admin downloads and installs the <span class="bold"><strong>Connector</strong></span> software and connects with the CloudConnexa Profile to establish WPC connection to the preconfigured CloudConnexa Region.</p></li><li class="listitem"><p>During WPC connection establishment CloudConnexa pushes down a route to the WPC Subnet range (<code class="code">100.96.0.0/11</code>) and the HQ Network subnet range <code class="code">10.0.0.0/18</code>.</p></li><li class="listitem"><p>Once the connection is established, the WPC is represented by a virtual interface that receives packets from the WPC and will be used to send packets destined to <code class="code">100.96.0.0/11</code> and <code class="code">10.0.0.0/18</code>.</p></li><li class="listitem"><p>In order for the <span class="bold"><strong>Connector</strong></span> instance to accept the packets received from its WPC interface and send it to the HQ Network LAN, the Connector needs to be configured to act as a router and forward IP packets using the right interface. Please see the section on <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530" title="Enable Routing">Enable Routing</a></strong></span>.</p></li><li class="listitem"><p>A static route is added to the router informing it to forward all traffic destined to CloudConnexa (100.96.0.0/11) to the Connector instance. See section for <span class="bold"><strong><a class="link linktype-component" href="../../settings-guides/connector-user-guides/connecting-networks-to-cloudconnexa-using-connectors.html#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e" title="Add Static Routes">Add Static Routes</a></strong></span> for references.</p></li><li class="listitem"><p>A computer on HQ Network now tries to reach the Finance Server on the Branch Network. It sends the packet to the Network’s router.</p></li><li class="listitem"><p>The router drops the packet because it has no route to reach the <code class="code">192.168.0.0/22</code> Network.</p></li><li class="listitem"><p>A static route is added with the <span class="bold"><strong>Connector</strong></span> instance as the destination for the Branch Network subnet.</p></li><li class="listitem"><p>Now, the packet is forward to the <span class="bold"><strong>Connector</strong></span> instance from the router.</p></li><li class="listitem"><p>With routing already enabled, the <span class="bold"><strong>Connector</strong></span> instance sends the packet to CloudConnexa using the WPC interface.</p></li><li class="listitem"><p>CloudConnexa forwards the packet on to the <span class="bold"><strong>Connector</strong></span> instance in Branch Network.</p></li><li class="listitem"><p>When the <span class="bold"><strong>Connector</strong></span> instance receives the packet destined to the Finance Server it forwards it on the LAN interface because it had been already set up as a router.</p></li><li class="listitem"><p>The Finance Server responds to the request but sends it to the Network’s router because the destination IP address of <code class="code">10.0.0.0.13</code> does not belong to its LAN.</p></li><li class="listitem"><p>The router forwards the packet to the <span class="bold"><strong>Connector</strong></span> because of the static route configured for <code class="code">100.96.0.0/11</code>.</p></li><li class="listitem"><p>With routing already enabled, the <span class="bold"><strong>Connector</strong></span> instance sends the packet to CloudConnexa using the WPC interface.</p></li><li class="listitem"><p>CloudConnexa forwards the packet on to the <span class="bold"><strong>Connector</strong></span> instance in HQ Network.</p></li><li class="listitem"><p>When the <span class="bold"><strong>Connector</strong></span> instance receives the packet destined to the computer on its LAN it forwards it on the LAN interface because it had been already set up as a router.</p></li><li class="listitem"><p>Now, a computer on the Branch Network tries to access the HR server that is in the HQ Network by sending the request packet to the router.</p></li><li class="listitem"><p>As the router does not have a static route for the HQ Network IP address range, it needs to be added in order to send the traffic flow to the <span class="bold"><strong>Connector</strong></span>.</p></li></ol></div></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-0bcf34b3-5f85-1d83-a2b6-382e4528cbca" data-publication-date="" id="UUID-bd814724-cb47-7e0e-47fc-2dd824888b5c"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Installation of Connector</strong></span></h3></div></div></div><p>The steps for installation of the <span class="bold"><strong>Connector</strong></span> are the same regardless of its use a <span class="bold"><strong>Host</strong></span> or a <span class="bold"><strong>Network Connector</strong></span>.</p><p><a class="link" href="https://openvpn.net/cloud-docs/installing-network-connector-linux/" target="_blank" rel="noopener">Connector on Linux</a></p><p><a class="link" href="https://openvpn.net/cloud-docs/installing-connector-for-windows/" target="_blank" rel="noopener">Connector on Windows</a></p><p><a class="link" href="https://openvpn.net/cloud-docs/installing-connector-for-macos/" target="_blank" rel="noopener">Connector on macOS</a></p><p><a class="link" href="https://openvpn.net/cloud-docs/launch-connector-on-aws/" target="_blank" rel="noopener">Connector on AWS</a></p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-0878ca34-325c-43cb-af2f-c3e6ae8dfb33" data-publication-date="" id="UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Enable Routing</strong></span></h3></div></div></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-cc55d8a5-c0a0-b337-5d35-1dfce13e1925" data-publication-date="" id="UUID-5598aa20-7999-8fb9-be89-8d7e5bddf742"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>Routing on Linux</strong></span></h4></div></div></div><p>To enable <span class="bold"><strong>IPv4</strong></span> forwarding, use the following commands on the command line:</p><pre class="programlisting">
               <code class="code">sudo sed -i 's/#net.ipv4.ip_forward=1/net.ipv4.ip_forward=1/g' /etc/sysctl.conf
sudo sysctl -p</code>
            </pre><p>To enable <span class="bold"><strong>IPv6</strong></span> forwarding</p><pre class="programlisting">
               <code class="code">sudo sed -i 's/#net.ipv6.conf.all.forwarding=1/net.ipv6.conf.all.forwarding=1/g' /etc/sysctl.conf
sudo sysctl -p</code>
            </pre><p>This will enable forwarding in the Linux kernel.</p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-852d3aa0-ce50-909c-3cd9-075d8c554d8f" data-publication-date="" id="UUID-6ada3f5b-8102-1c01-bdd0-8d6c1f78f454"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>Routing on Windows</strong></span></h4></div></div></div><p>Please look at the documentation for your specific Windows version. For your convenience references on how to deploy the Routing and Remote Access Service for Windows Server 2016 are given below.</p>https://docs.microsoft.com/en-us/windows-server/remote/remote-access/ras/remote-access-server-role-documentation<p>After installation of the routing and <span class="bold"><strong>Remote Access</strong></span> service, do the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>From <span class="bold"><strong>Server Manager</strong></span>, click <span class="bold"><strong>Tools</strong></span>, and select <span class="bold"><strong>Routing and Remote Access</strong></span>.</p></li><li class="listitem"><p>From the <span class="bold"><strong>Routing and Remote Access </strong></span> window, <span class="emphasis"><em>right click</em></span> the server, and select <span class="bold"><strong>Configure and Enable Routing and Remote Access</strong></span>.</p></li><li class="listitem"><p>On the first page of the set up wizard, click on the <span class="bold"><strong>Next</strong></span> button.</p></li><li class="listitem"><p>Select <span class="bold"><strong>Custom</strong></span> configuration and click on the <span class="bold"><strong>Next</strong></span> button.</p></li><li class="listitem"><p>Select <span class="bold"><strong>LAN routing</strong></span> and click on the <span class="bold"><strong>Next</strong></span> button.</p></li><li class="listitem"><p>On the summary page, click on the <span class="bold"><strong>Finish</strong></span> button.</p></li><li class="listitem"><p>Finally, to start the service, click on the <span class="bold"><strong>Start service</strong></span> button and wait for the service to start. The dot on the server will turn the color green from the color red.</p></li><li class="listitem"><p>Now, expand the server and expand <span class="bold"><strong>IPv4</strong></span> entry to click on the <span class="bold"><strong>General</strong></span> node. The computer is now acting as a router between the interfaces shown.</p></li></ul></div><p>See, <a class="link" href="https://openvpn.net/cloud-docs/connecting-to-a-windows-server-2016-network/" target="_blank" rel="noopener">Connecting to a Windows Server 2016 Network</a></p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-d35f3a0b-e527-0ef0-5cd5-8d16fdf970b1" data-publication-date="" id="UUID-da61762c-d69e-0c6c-ace4-662160b92eb9"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>Routing on macOS</strong></span></h4></div></div></div><p>Open the Terminal application and type</p><pre class="programlisting">
               <code class="code">sysctl -w net.inet.ip.forwarding=1</code>
            </pre></section></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-26ebad8e-58d9-9d9a-07f6-2804d43de2ba" data-publication-date="" id="UUID-902d63f8-9840-8ce8-d0c3-ac8d04e12b23"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Enable NAT</strong></span></h3></div></div></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-01c6c85d-b8f7-daab-cc7c-98b3bdaa6996" data-publication-date="" id="UUID-0522b8f4-1045-55c4-2cc5-f667bef8212b"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>NAT on Linux</strong></span></h4></div></div></div><p>Use the following commands on the command line:</p><pre class="programlisting">
               <code class="code">sudo apt install iptables-persistent
IF=`ip route | grep default | awk '{print $5}'`
sudo iptables -t nat -A POSTROUTING -o $IF -j MASQUERADE
sudo iptables-save | sudo tee /etc/iptables/rules.v4
sudo ip6tables -t nat -A POSTROUTING -o $IF -j MASQUERADE
sudo iptables-save | sudo tee /etc/iptables/rules.v6</code>
            </pre><p>The iptables rule uses the NAT packet matching table <code class="code">(-t nat)</code> and specifies the built-in <code class="code">POSTROUTING</code> chain for NAT <code class="code">(-A POSTROUTING)</code> on the external networking Device<code class="code"> (-o $IF)</code>. The variable ‘IF’ stores the default interface. <code class="code">POSTROUTING</code> allows packets to be altered as they are leaving the Connector instance. The <code class="code">-j MASQUERADE</code> target is specified to mask the private IP address of a node with the IP address assigned to the default interface.</p><p>The above is sufficient if you are fine with all traffic being NATted. However, if you need Hosts on the Network to distinguish between different WPC clients or Connectors, you need to use “<code class="code">! -d xx.xx.xx.xx/xx</code>” in the NAT rule where <code class="code">xx.xx.xx.xx/xx</code> is the subnet of the target LAN subnet, otherwise traffic to that subnet will also be NATted. The example below shows how to use the iptables command so that NAT is not used if the destination is in the <code class="code">10.10.0.0/16</code> subnet.</p><pre class="programlisting">
               <code class="code">sudo iptables -t nat -A POSTROUTING -o $IF ! -d 10.10.0.0/16 -j MASQUERADE</code>
            </pre></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-8b96bcdf-401e-d15c-28a9-7b263d2ca1a5" data-publication-date="" id="UUID-9d9c68f6-53d4-89d6-f6bf-ee52e87cd70c"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>NAT on Windows</strong></span></h4></div></div></div><p>A tutorial can be found here:</p><div class="mediaobject"><div class="video-container"><div class="videoobject"><iframe style="border:0;" allow="fullscreen *" src="https://www.youtube.com/embed/a1xYi6pxA_4"></iframe></div></div></div></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-3f793505-1394-b4ed-4b6c-79d29bc271e4" data-publication-date="" id="UUID-8360591e-8fb1-cace-8abf-6754f6cbca93"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>NAT on macOS</strong></span></h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Create a file called <code class="code">pf-nat.conf</code> with the following content: <code class="code">nat on en0</code> from <code class="code">utun0</code> to any<code class="code"> -&gt; (en0)</code></p></li><li class="listitem"><p>Save the file and now start <code class="code">pfctl</code> using the rule from the file we have created earlier:</p><p><code class="code">sudo pfctl -d</code> #disables <code class="code">pfctl</code></p><p><code class="code">sudo pfctl -F all</code> #flushes all <code class="code">pfctl</code> rules</p><p><code class="code">sudo pfctl -f /Path/to/file/pf-nat.conf -e</code> #starts pfctl and loads the rules from the <code class="code">pf-nat.conf</code> file</p></li></ol></div></section></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-8d3a6289-1f64-974b-6d64-95b3e4781b41" data-publication-date="" id="UUID-cd51b4db-50d1-265e-1abd-87bc9c4a3130"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Special Considerations for IaaS</strong></span></h3></div></div></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-159d7e50-2061-30fb-127a-c78e62a35fa8" data-publication-date="" id="UUID-da851b80-f453-fdbe-3414-e46a074c6504"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="bold"><strong>Security Groups</strong></span></h4></div></div></div><p>If you are using <span class="bold"><strong>Security Groups</strong></span> to protect any instances that need their traffic to be routed through the <span class="bold"><strong>Connector</strong></span> instance, you need to add the <span class="bold"><strong>Security Group</strong></span> of the <span class="bold"><strong>Connector</strong></span> instance to their inbound rules.</p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-e249dcb7-d5ab-37b3-9a64-7369d5d75ca9" data-publication-date="" id="UUID-12206eb6-eedd-3315-89bc-0c9053c5836f"><div class="titlepage"><div><div class="title"><h4 class="title">AWS</h4></div></div></div>https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html<p> <a class="link" href="https://openvpn.net/cloud-docs/launch-connector-on-aws/" target="_blank" rel="noopener">Launch Connector on AWS</a> </p></section></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-6cd1f31f-3791-b2fd-34df-d8d84d026d70" data-publication-date="" id="UUID-30aae362-da93-d594-16ed-06c96757b47b"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>Set Source/Dest Check</strong></span></h3></div></div></div><p>Virtual servers provided by IaaS providers use virtual Network interface cards (<span class="bold"><strong>VNIC</strong></span>). By default, every VNIC performs the source/destination check on its Network traffic. The VNIC looks at the source and destination listed in the header of each Network packet. If the VNIC is not the source or destination, then the packet is dropped.</p><p>In order for the instance on which the <span class="bold"><strong>Connector</strong></span> is installed to perform routing or <span class="bold"><strong>NAT</strong></span> functionality the Source/Dest check on the VNIC needs to be turned <span class="bold"><strong>OFF</strong></span>.</p><p>Please refer to the documentation provided by your IaaS provide to disable source/dest check. For your convenience documentation references are provided below:</p><p><span class="bold"><strong>AWS:</strong></span> <a class="link" href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_NAT_Instance.html#EIP_Disable_SrcDestCheck" target="_blank" rel="noopener">https://docs.aws.amazon.com/vpc/latest/userguide/VPC_NAT_Instance.html#EIP_Disable_SrcDestCheck</a></p><p><span class="bold"><strong>Oracle:</strong></span> <a class="link" href="https://docs.cloud.oracle.com/en-us/iaas/Content/Network/Tasks/managingVNICs.htm#Source/D" target="_blank" rel="noopener">https://docs.cloud.oracle.com/en-us/iaas/Content/Network/Tasks/managingVNICs.htm#Source/D</a></p><p><span class="bold"><strong>Azure:</strong></span> IP forwarding must be enabled at the VNIC https://docs.microsoft.com/en-us/azure/virtual-Network/virtual-Network-network-interface#enable-or-disable-ip-forwarding</p><p><span class="bold"><strong>GCP:</strong></span> <a class="link" href="https://cloud.google.com/vpc/docs/using-routes#canipforward" target="_blank" rel="noopener">https://cloud.google.com/vpc/docs/using-routes#canipforward</a></p><p>Also, note that when running some Linux firewall packages, <code class="code">rpfilter</code> is sometimes turned <span class="bold"><strong>On</strong></span></p><p><a class="link" href="https://tldp.org/HOWTO/Adv-Routing-HOWTO/lartc.kernel.rpf.html" target="_blank" rel="noopener">https://tldp.org/HOWTO/Adv-Routing-HOWTO/lartc.kernel.rpf.html</a>. In addition to source/dest check, <code class="code">rp_filter</code> in <code class="code">sysctl.conf</code> should be turned <span class="bold"><strong>Off</strong></span></p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-4ff0b88a-5b44-d468-073c-8f61d362bacd" data-publication-date="" id="UUID-84ebad4f-32c0-b835-4f88-72a3bb2890af"><div class="titlepage"><div><div class="title"><h3 class="title"><span class="bold"><strong>AWS Route Updates</strong></span></h3></div></div></div><p>If you have followed the instructions for using <span class="bold"><strong>CloudFormation</strong></span> to install <span class="bold"><strong>Connector</strong></span> on AWS, any needed static routes will be added to the VPC route table by the <span class="bold"><strong>Connector</strong></span>. There is no need to manually add static routes in the VPC route table.</p><p><a class="link" href="https://openvpn.net/cloud-docs/launch-connector-on-aws/" target="_blank" rel="noopener">Launch Connector on AWS</a></p></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-dede9442-6cff-bcd9-9728-8954a87af9db" data-publication-date="" id="UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e"><div class="titlepage"><div><div class="title"><h3 class="title">Add Static Routes</h3></div></div></div><p>All routers provide the ability to add a static route. Please refer to your router documentation. For Virtual Cloud Networks, we have provided references below for some IaaS providers.</p><p>A static route needs to be added to the WPC IP address range of CloudConnexa. The <span class="bold"><strong>default WPC IP address range</strong></span> is <code class="code">100.96.0.0/11</code> for CloudConnexa. The static route added should have <code class="code">100.96.0.0/11</code> as the destination IP address range and the private IP address of the <span class="bold"><strong>Connector</strong></span> instance as the <span class="bold"><strong>Target</strong></span>.</p><p>A <span class="bold"><strong>static route</strong></span> needs to be added for the <span class="bold"><strong>destination subnet ranges</strong></span> of your other <span class="bold"><strong>Networks</strong></span> that are connected to CloudConnexa too.</p><p>The figure below shows the static routes added to a VPC route table. You can see that there are three routes pointing to <code class="code">eni-06e725657ba3a8f63</code> (the instance that is running the <span class="bold"><strong>Connector</strong></span> software). <code class="code">172.31.0.0/16</code> is the subnet of another <span class="bold"><strong>Network</strong></span> that can be accessed via CloudConnexa.</p><div class="mediaobject"><img src="../../../image/uuid-047c94aa-6af5-e454-97e9-c024ab32bdab.png" style="" alt="62e9bb0838b2d.png"></img></div><p><span class="bold"><strong>AWS:</strong></span> If you have followed the instructions for using <span class="bold"><strong>CloudFormation</strong></span> to install <span class="bold"><strong>Connector</strong></span> on AWS, any needed static routes will be added to the VPC route table by the <span class="bold"><strong>Connector</strong></span>. There is no need to manually add static routes in the VPC route table. See, <a class="link" href="https://openvpn.net/cloud-docs/launch-connector-on-aws/" target="_blank" rel="noopener">Launch Connector on AWS</a></p><p><span class="bold"><strong>Azure:</strong></span> Azure calls static routes as ‘User-defined’. See, <a class="link" href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-udr-overview" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/azure/virtual-Network/virtual-Networks-udr-overview</a></p><p><span class="bold"><strong>GCP:</strong></span> <a class="link" href="https://cloud.google.com/vpc/docs/using-routes" target="_blank" rel="noopener">https://cloud.google.com/vpc/docs/using-routes</a></p><p><span class="bold"><strong>Oracle Cloud:</strong></span> See, using Private IP as a route target <a class="link" href="https://docs.cloud.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm#Route" target="_blank" rel="noopener">https://docs.cloud.oracle.com/en-us/iaas/Content/Network/Tasks/managingroutetables.htm#Route</a></p></section></section></section><div class="footer-content"><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-6b5e5713-a0bb-11ba-573b-2cb3552b8dc6">Connecting Networks to CloudConnexa Using Connectors</a></li><li><a href="#UUID-8a8036df-9c9a-d724-991a-22827a1d5e59"></a><ul class="nav"><li><a href="#UUID-1c56ca39-c7a8-a2d7-36b3-914cd65823e1">Introduction</a></li><li><a href="#UUID-d6a61ea7-3675-24e0-88d2-3682d4649ce9">Remote access to private services</a></li><li><a href="#UUID-56e65918-8289-cdf6-15cd-ad3f67b0e5bd">HQ Network being used as Internet Gateway route</a></li><li><a href="#UUID-37db5cc5-5025-30c3-282e-06a56cc941b1">Site-to-Site</a></li><li><a href="#UUID-bd814724-cb47-7e0e-47fc-2dd824888b5c">Installation of Connector</a></li><li><a href="#UUID-5eb6fb2f-4ade-7edf-a59a-e904c59e1530">Enable Routing</a><ul class="nav"></ul></li><li><a href="#UUID-902d63f8-9840-8ce8-d0c3-ac8d04e12b23">Enable NAT</a><ul class="nav"></ul></li><li><a href="#UUID-cd51b4db-50d1-265e-1abd-87bc9c4a3130">Special Considerations for IaaS</a><ul class="nav"></ul></li><li><a href="#UUID-30aae362-da93-d594-16ed-06c96757b47b">Set Source/Dest Check</a></li><li><a href="#UUID-84ebad4f-32c0-b835-4f88-72a3bb2890af">AWS Route Updates</a></li><li><a href="#UUID-401a61f2-9092-bddd-8fd5-5d467a5b869e">Add Static Routes</a></li></ul></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div class="voting-title">Was this helpful?</div><div class="btn-group btn-group-toggle" data-toggle="buttons"><button id="feedback-yes-btn" class="btn toggle-yes">Yes</button><button id="feedback-no-btn" class="btn">No</button></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" class="prev pull-left prev visible-lg visible-md" id="header-navigation-prev" href="connector-deployment-user-guides.html">Prev</a></li><li class="next"><a accesskey="n" class="pull-right next visible-lg visible-md" id="header-navigation-next" href="user-guide---using-multiple-connectors-to-increase-reliability-of-remote-access.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2023  </div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div><script type="text/javascript">
var theme = '0';

			
			window.versionsfile = '';


			window.indexDict = new Array();
			window.store = {};
			window.portalLanguage = 'en';
			window.enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				var instantsearch_minlength = 1;
						
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><script src="../../../../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../../../../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../../../../js/materialize.min.js" type="text/javascript"></script><script src="../../../../js/bootstrap.min.js" type="text/javascript"></script><script src="../../../../js/purl.js" type="text/javascript"></script><script src="../../../../js/jquery.smartmenus.js" type="text/javascript"></script><script src="../../../js/toc.js" type="text/javascript"></script><script src="../../../../js/create-toc.js" type="text/javascript"></script><script src="../../../../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../../../../js/html5-2.js" type="text/javascript"></script><script src="../../../../js/checklist.js" type="text/javascript"></script><script src="../../../../js/clipboard.min.js" type="text/javascript"></script><script src="../../../../js/anchorlinks.js" type="text/javascript"></script><script src="../../../../js/html5.algoliasearch.js" type="text/javascript"></script><script src="../../../../js/csh.js" type="text/javascript"></script><script src="../../../../js/layout-custom-script.js" type="text/javascript"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><script type="text/javascript">const containerId = 'GTM-W3DL2JV';

						$(document).on('cookies.consented', () => {
							(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
								new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
								j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
								'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
							})(window,document,'script','dataLayer',containerId);
						});
					</script><script type="text/javascript" src="../../../../js/cookie-consent.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script><script type="text/javascript">
			$(document).ready(function() {

				$('pre:not(.embedcode)').each(function() {
					/**
					 * @type {string}
					 */
					var language = $(this).data('language');

					if (language === 'plaintext' || language === 'text') {
						$(this).addClass(language).addClass('hljs');
						return true;
					}
					else {
						var clone = this.cloneNode(true);
						hljs.highlightBlock(clone);
						$(this).empty().append($(clone).contents());
						$(this).attr("class", $(clone).attr("class"));
					}
				});
			});
			</script><script type="text/javascript">var publication_id = 'docs_index';
var algolia_application_id = 'RSWCYN6WCZ';
var algolia_search_only_api_key = '62cb66cce7985fc867c172fa2d12bc1c';
</script><script src="https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W3DL2JV" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--></body></html>
